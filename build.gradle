
buildscript {
  repositories {
    jcenter()
  }
  dependencies {
    classpath 'org.standardout:gradle-eclipseconfig:1.1.0'
  }
}

plugins {
  id 'com.google.cloud.tools.jib' version '1.0.0'
}

repositories {
  mavenCentral()
  jcenter()
  maven {
    url "http://packages.confluent.io/maven/"
  }
}

apply plugin: 'java'
apply plugin: "idea"
apply plugin: "eclipse"
apply plugin: "maven"
apply plugin: "jacoco"
// for .editorconfig support in Eclipse
apply plugin: 'org.standardout.eclipseconfig'

group 'se.yolean'

sourceCompatibility = 1.8

jib {
  from {
    image = 'gcr.io/distroless/java@sha256:31d5dfbf339e09dd31524dc301df29ac066744bad5a89a20ffa582e33d01e998'
  }
  to {
    image = 'yolean/kafka-topics-copy'
    tags = ['dev']
  }
}

dependencies {
  compile group: 'org.apache.kafka', name: 'kafka-clients', version: '2.1.1'
  compile group: 'org.apache.kafka', name: 'kafka-streams', version: '2.1.1'

  compile group: 'org.apache.logging.log4j', name: 'log4j-api', version: '2.11.2'
  compile group: 'org.apache.logging.log4j', name: 'log4j-core', version: '2.11.2'
  runtime group: 'org.apache.logging.log4j', name: 'log4j-slf4j-impl', version: '2.11.2'

  compile group: 'io.prometheus', name: 'simpleclient', version: '0.6.0'
  compile group: 'io.prometheus', name: 'simpleclient_servlet', version: '0.6.0'

  compile group: 'net.sf.jopt-simple', name: 'jopt-simple', version: '5.0.4'

  testCompile("org.junit.jupiter:junit-jupiter-api:5.4.0")
  testRuntime("org.junit.jupiter:junit-jupiter-engine:5.4.0")
  testRuntime("org.junit.platform:junit-platform-launcher:1.4.0")
  testCompile group: 'org.mockito', name: 'mockito-core', version: '2.24.0'

  testCompile group: 'org.apache.kafka', name: 'kafka-streams-test-utils', version: '2.1.1'
}

test {
  useJUnitPlatform()
}
